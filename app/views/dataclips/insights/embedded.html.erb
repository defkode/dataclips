<script>
  Dataclips.config = {
    locale: '<%= I18n.locale %>',
    id: '<%= @clip_id %>',
    url: '<%= insight_path(@insight) %>',
    schema: <%= raw @schema.to_json %>,
    headers: <%= raw @headers.to_json %>,
    variables: <%= raw @variables.to_json %>
  };

  $(window).resize(function(){
    $("#grid, #sidebar").css("height", $(window).height());
  });

  $(document).ready(function(){
    $(window).trigger("resize");
    Dataclips.run();
  });
</script>

<div id="grid"></div>

<div id="filters">
  <div id="sidebar">
  <% @schema.each do |key, options| %>
    <% id = "#{@clip_id}_#{key}" %>
    <div class="row">
      <div class="col-md-10">
        <h4 class="panel-title">
          <%= @headers[key] %>
        </h4>
      </div>
      <div class="col-md-2 text-right">
        <button data-key="<%= key %>" class="reset btn btn-xs btn-default"><i class="fa fa-times"></i></button>
      </div>
    </div>

    <div class="form-group">
      <% if options[:type] == "text" %>
        <%= render "text", key: key, id: id, dictionary: options[:dictionary] %>
      <% end %>

      <% if options[:type] == "datetime" %>
        <%= render "datetime", key: key, id: id %>
      <% end %>

      <% if options[:type] == "date" %>
        <%= render "date", key: key, id: id %>
      <% end %>

      <% if options[:type] == "time" %>
        <%= render "time", key: key, id: id %>
      <% end %>

      <% if options[:type] == "integer" %>
        <%= render "integer", key: key, id: id %>
      <% end %>

      <% if options[:type] == "float" %>
        <%= render "float", key: key, id: id %>
      <% end %>

      <% if options[:type] == "boolean" %>
        <%= render "boolean", key: key, id: id %>
      <% end %>
    </div>
  <% end %>
  <div>
</div>

<div id="modal"></div>

<canvas id="progress" width="240" height="240"></canvas>



